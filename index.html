<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yusuf Bıyık</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="fluiditype.css">
</head>
<body onload="loadContent('detailed-gallery', 'projelerim')">
    <div class="container">
        <div class="topbar">
            <a target="_blank" href="https://github.com/yussufbiyik">GitHub</a>
            <a target="_blank" href="https://codepen.io/yusufbiyik">CodePen</a>
            <a href="mailto:yussuf.jpeg@gmail.com">yussuf.jpeg@gmail.com</a>
        </div>
        <div class="content border-no-hover">
            <div id="bio" class="left-content">
                <div id="bio-text">
                    <h1>Yusuf Bıyık</h1>
                    <p id="bio-paragraph">Yazılıma 8. sınıfta HTML, CSS ve PHP öğrenerek başladım ve o günden beri kendim, çevrem ve müşterilerim için kendimi aşan projeler yaparak gelişiyorum.</p>    
                </div>
                <div class="link-list">
                    <a id="projelerim" onclick="loadContent('detailed-gallery', 'projelerim')" href="#content">Projelerim</a>
                    <a id="snippets" onclick="loadContent('custom', 'snippets')" href="#content">Ufak Parçalar</a>
                    <a id="yetkinliklerim" onclick="loadContent('custom', 'yetkinliklerim')" href="#content">Yetkinliklerim</a>
                    <a id="pixel-art" onclick="loadContent('gallery', 'pixel-art')" href="#content">Pixel Art</a>
                    <a id="3d-modelleme-renderlar" onclick="loadContent('gallery', '3d-modelleme-renderlar')" href="#content">3D Modelleme/Renderlar</a>
                    <div class="language-selector">
                        <div class="language-select" title="Türkçe" id="turkish" data-name="tr"></div>
                        <div class="language-select" title="English" id="english" data-name="eng"></div>
                    </div>
                    <div class="pattern-selector">
                        <div class="pattern-select" title="noise" id="noiseBackgroundPattern" data-name="noise"></div>
                        <div class="pattern-select" title="dna" id="dnaBackgroundPattern" data-name="dna"></div>
                    </div>
                    <div class="theme-selector">
                        <div class="theme-select" title="darkside" id="darkside" data-name="darkside"></div>
                        <div class="theme-select" title="flashbang" id="flashbang" data-name="flashbang"></div>
                        <div class="theme-select" title="neo" id="neo" data-name="neo"></div>
                        <div class="theme-select" title="bios" id="bios" data-name="bios"></div>
                        <div class="theme-select" title="sepia" id="sepia" data-name="sepia"></div>
                    </div>
                    <small style="gap: 2px;display: grid;grid-auto-flow: column;align-items: center;justify-content: start;">
                        <input type="checkbox" name="bgAnimationCheckbox" id="bgAnimationCheckbox">
                        <label for="bgAnimationCheckbox">Arka plan değişimini kapat.</label>
                    </small>
                    <small>En iyi deneyim için masaüstünde ziyaret edin.</small>
                    <small>
                        Kasmalar yaşayabilirsiniz, <abbr style="cursor: help;" title="SVG filter ile yapıldığı için bi tık zorluyor, çözmeye, olmazsa da alternatiflerini bulmaya çalışıyorum merak etmeyin.">arka plandan</abbr> kaynaklanıyor.
                    </small>
                </div>
            </div>
            <div id="content" class="right-content moveable">
                <h2 id="content-heading"></h2>
                <div id="content-details" class="">
                </div>
            </div>
        </div>
        <div class="bottombar">
            <!-- 
                TODO:
                    * Prevent html, js message input
                    * Give ID's to users based on their number on the visitor list,
                    * Customize incoming and outgoing texts to look more like a chatroom from old web,
                    * Add Turkish profanity filter then add English,
                    * Add commands for some easter eggs and backsite gateways.
            -->
            <span>💬 Chat</span>
            <div id="chat-box">
                <div id="chat-messages"></div>
                <div id="chat-input-container">
                    <input placeholder="Mesajını gir, lütfen kötü konuşma." type="text" id="message-input">
                    <button id="message-submit-button">→</button>
                </div>
            </div>
        </div>
    </div>
    <svg id="svg-filter" width='300' height='300' style="display: none;">
        <filter id='noiseFilter'>
            <feTurbulence 
                id="turbulence"
                type='turbulence' 
                baseFrequency='.99' 
                numOctaves='2' 
                stitchTiles='stitch'
                result="turbulence">
            </feTurbulence>
            <feDisplacementMap
                id="dispMap"
                in2="turbulence"
                in="SourceGraphic"
                result="fractal"
                scale="-1920"
                xChannelSelector="R"
                yChannelSelector="G">
            </feDisplacementMap>
        </filter>
    </svg>
    <script src="./datasource.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js";
        import { getFirestore, doc, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js"

        //! FIREBASE CONFIG IS HIDDEN IN ORDER TO COMMIT THE CHANGES, THIS WILL BE LIKE THIS UNTIL I FIGURE IT OUT

        // Initialize Firebase
        const fireApp = initializeApp(firebaseConfig);
        const cloudDatabase = getFirestore(fireApp);
        const msNow = Date.now();
        // List chat messages in ascending order of creation date
        const q = query(collection(cloudDatabase, "chat-messages"), orderBy("createdAt", "asc"));
        // Define a variable to determine if the all the messages loaded initally
        var didMessagesLoad = false;
        const chatMessagesElement = document.getElementById('chat-messages');

        const messages = [];
        // Triggers when collection is changed whether by a new document or by an updated one
        const unsubscribe = onSnapshot(q, (querySnapshot) => {
            // Following 2 functions return values that are CSS classes, these classes modify the look of the message.
            const isAdmin = (name) => {if(name === "yusufbiyik") return "isAdmin"}
            const isPinned = (pinValue) => {if(pinValue && pinValue == true) return "isPinned"}
            // Turns message createdAt(creation date) to HH:MM:SS format
            const formatCreationDate = (docData) => {
                const messageTime = new Date(docData.createdAt.seconds*1000).toTimeString().split(' ')[0];
                return messageTime
            }
            // If messages  were initally loaded, then there is no need to load all the messages again,
            // so otherwise load only the changes,
            // Following if statement does exactly that.
            if(didMessagesLoad === false) {
                querySnapshot.forEach((doc) => {
                    messages.push(doc.data());
                    // Add the message to the message container
                    chatMessagesElement.innerHTML += `
                        <div class="chat-message ${isPinned(doc.data().isPinned)}">
                            <span class="message-author">[<span class="${isAdmin(doc.data().author)}">${doc.data().author}</span>]</span>
                            <span class="message-hour">[${formatCreationDate(doc.data())}]:</span>
                            <span class="message">${doc.data().message}</span>
                        </div>`
                });
                didMessagesLoad = true;
                // Scroll to bottom
                chatMessagesElement.scrollTop = chatMessagesElement.offsetHeight;
            }else {
                querySnapshot.docChanges().forEach(change => {
                    messages.push(change.doc.data())
                    // Add the message to the message container
                    chatMessagesElement.innerHTML += `<div class="chat-message ${isPinned(change.doc.data().isPinned)}">
                            <span class="message-author">[<span class="${isAdmin(change.doc.data().author)}">${change.doc.data().author}</span>]</span>
                            <span class="message-hour">[${formatCreationDate(change.doc.data())}]:</span>
                            <span class="message">${change.doc.data().message}</span>
                        </div>`
                })
                // Scroll to bottom if the user isn't far away from it
                if(chatMessagesElement.scrollHeight<200) {chatMessagesElement.scrollTop = chatMessagesElement.offsetHeight}
            }
        });
    </script>
    <script src="./app.js"></script>
<!--     
               ▀                    ▀
    ▄█   ▄█▄  ▄█    ▄▄▄▄███▄▄▄▄    ▄█  
    ███ ▄███▀ ███  ▄██▀▀▀███▀▀▀██▄ ███  
    ███▐██▀   ███▌ ███   ███   ███ ███▌ 
    ▄█████▀    ███▌ ███   ███   ███ ███▌ 
    ▀▀█████▄    ███▌ ███   ███   ███ ███▌ 
    ███▐██▄   ███  ███   ███   ███ ███  
    ███ ▀███▄ ███  ███   ███   ███ ███  
    ███   ▀█▀ █▀    ▀█   ███   █▀  █▀   
    ▀                                     
-->
</body>
</html>